\documentclass[shownotes,aspectratio=169]{beamer}

\input{../../aux/tex/diapo_encabezado.tex}
\input{../../aux/tex/tikzlibrarybayesnet.code.tex}
 \mode<presentation>
 {
 %   \usetheme{Madrid}      % or try Darmstadt, Madrid, Warsaw, ...
 %   \usecolortheme{default} % or try albatross, beaver, crane, ...
 %   \usefonttheme{serif}  % or try serif, structurebold, ...
  \usetheme{Antibes}
  \setbeamertemplate{navigation symbols}{}
 }
 
\usepackage{todonotes}
\setbeameroption{show notes}

\newif\ifen
\newif\ifes
\newcommand{\en}[1]{\ifen#1\fi}
\newcommand{\es}[1]{\ifes#1\fi}
\estrue

%\title[Bayes del Sur]{}

\begin{document}

\color{black!85}
\large
 
%\setbeamercolor{background canvas}{bg=gray!15}


\begin{frame}[plain,noframenumbering]
 
 \begin{textblock}{90}(00,05)
\begin{center}
 \huge  \textcolor{black!66}{Creencias adaptativas}
\end{center}
\end{textblock}

 %\vspace{2cm}brown
%\maketitle
\Wider[2cm]{
\includegraphics[width=1\textwidth]{../../aux/static/peligro_predador}
}
\end{frame}

\begin{frame}[plain]
%  \begin{textblock}{160}(0,4)
%  \centering \Large
%  Judea Pearl
%  \end{textblock}
\centering
% \vspace{1cm}
 
\includegraphics[width=0.35\textwidth]{../../aux/static/causality2-cover} 
 
  \normalsize
  \vspace{0.2cm}
  
\Wider[2cm]{\centering In this book, we shall express preference toward Laplace’s deterministic conception of causality}
 
\end{frame}





% \begin{frame}[plain]
%  \begin{textblock}{160}(0,4)
%  \centering \Large
%  Modelos Causales
%  \end{textblock}
%  
%  Permiten definir la distribución conjunta a priori:
%  \begin{itemize}
%   \item[$\bullet$] Dividiendo las creencias por los caminos del modelo causal. (Lo vimos)
%   \item[$\bullet$] Definiendo las creencias a priori de cada una de las variables (Lo vamos a ver hoy)
%  \end{itemize}
%  
%  Permiten actualizar la distribución conjunta:
%  \begin{itemize}
%   \item[$\bullet$] Aplicando la regla del producto $P(H|D) = P(H,D)/P(D)$ (Ya lo vimos)
%   \item[$\bullet$] Aplicando eficientemente la regla del producto aprovechando la estructura del modelo causal. (Lo vamos a ver hoy)
%   \item[$\bullet$] Modificando el modelo causal simulando experimentos. (Lo vamos a ver más adelante)
%  \end{itemize}
%  
%  \end{frame}

\begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Modelos Causales
 \end{textblock}
 \centering
 \vspace{0.75cm}
 
 \tikz{
    \node[det] (l) {$l$} ; %
    \node[det, above=of l] (a) {$a$} ; %
    \node[det, above=of a,xshift=1.5cm] (t) {$t$} ; %
    \node[det, above=of a,xshift=-1.5cm] (e) {$e$} ; %
    \node[det, below=of t,xshift=1.5cm] (r) {$r$} ; %
    
    \edge {a} {l};
    \edge {t,e} {a};
    \edge {t} {r};
    
    \node[const, left= of e, xshift=-0.1cm] (cpd_e) {Entradera:};
    \node[const, right= of t, xshift=0.1cm] (cpd_t) {:Terremoto};
    \node[const, left= of a, xshift=-0.1cm] (cpd_a) {Alarma:};
    \node[const, right= of r, xshift=0.1cm] (cpd_r) {:Redes};
    \node[const, left= of l, xshift=-0.1cm] (cpd_l) {Llamada:};
    
    }


 
 \end{frame}


 
%  \begin{frame}[plain]
%     \begin{textblock}{160}(0,4)
%     \centering \Large
%     Modelos Causales
%     \end{textblock}
%     \centering
%     \vspace{0.75cm}
% 
%     
%     \begin{itemize}
%      \item[$\bullet$] provide convenient means of expressing substantive assumptions
%      \item[$\bullet$] facilitate economical representation of joint probability functions 
%      \item[$\bullet$] facilitate efficient inferences from observations
%     \end{itemize}
% 
%      
%  \end{frame}


 \begin{frame}[plain]
 \begin{textblock}{160}(0,4)
 \centering \Large
 Causalidad
 \end{textblock}

 \centering \normalsize
 Causal relationships are expressed in the form of deterministic, functional equations, and probabilities are introduced through the assumption that certain variables in the equations are unobserved.

\end{frame} 
 
 \begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Mecanismos Causales
 \end{textblock}
 \vspace{0.75cm}
 
 \begin{align*}
  \onslide<1->{e &= u_e \\ 
  t &= u_t \\}
  \onslide<2->{r &= f(t,u_r) = t \vee u_r \\}
  \onslide<3->{a &= f(e,t,u_a) = e \vee t \vee u_a \\}
  \onslide<4->{l &= f(a,u_l) = a \vee u_l}
 \end{align*} 
 \end{frame}

 \begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Proabilidad conjunta
 \end{textblock}
 \vspace{0.75cm}
 
 
\only<1>{
\begin{textblock}{140}(10,34)
\begin{mdframed}[backgroundcolor=black!15]
 \centering 
  Los modelos son \'utiles para definir distribuciones 
  
  de probabilidad en espacios de alta dimensión.
\end{mdframed}
\end{textblock}
}


\only<2>{
\begin{textblock}{130}(18,33)
\begin{flalign*}
 & P(e,t,a,r,l) = && 
\end{flalign*}
\end{textblock}
}

\only<3>{
\begin{textblock}{130}(18,33)
\begin{flalign*}
 & P(e,t,a,r,l) = P(e)\,P(t|e)\,P(a|t,e)\,P(r|a,t,e)\,P(l|a,r,t,e) && 
\end{flalign*}
\end{textblock}
}

\only<4>{
\begin{textblock}{130}(18,33)
\begin{flalign*}
 & P(e,t,a,r,l) = P(e)\,P(t|\cancel{e})\,P(a|t,e)\,P(r|\cancel{a},t,\cancel{e})\,P(l|a,\cancel{r},\cancel{t},\cancel{e}) && 
\end{flalign*}
\end{textblock}
}

\only<5>{
\begin{textblock}{130}(18,33)
\begin{flalign*}
 & P(e,t,a,r,l) = P(e)\,P(t)\,P(a|t,e)\,P(r|t)\,P(l|a) && 
\end{flalign*}
\end{textblock}
}

\only<6>{
\begin{textblock}{130}(17.3,33)
\begin{flalign*}
 & \underbrace{P(e,t,a,r,l)}_{\text{Complejidad } 2^n} = P(e)\,P(t)\,P(a|t,e)\,P(r|t)\,P(l|a) && 
\end{flalign*}
\end{textblock}
}

\only<7>{
\begin{textblock}{130}(17.3,33)
\begin{flalign*}
 & \underbrace{P(e,t,a,r,l)}_{\text{Complejidad } 2^n} = \underbrace{P(e)}_{2}\underbrace{P(t)}_{2}\underbrace{P(a|t,e)}_{2^3}\underbrace{P(r|t)}_{2^2}\underbrace{P(l|a)}_{2^2} && 
\end{flalign*}
\end{textblock}
}


 
%  
%  \only<1->{
%  \begin{textblock}{160}(0,14)
% \begin{align*}
%   \underbrace{P(e,t,r,a,l)}_{\text{Complejidad } 2^n} = \onslide<2->{\underbrace{P(e)P(t)P(r|t)P(a|e,t)P(l|a)}_{\text{Complejidad } 2 + 2 + 2^2 + 2^3 + 2^2}}
%  \end{align*}
%  \end{textblock}
% }
% 
% \begin{textblock}{160}(0,34)
%  \onslide<3>{
%  \begin{align*}
%  P(e|t,r,a,l) & = P(e) \\
%  P(t|e,r,a,l) & = P(t) \\
%  P(r|e,t,a,l) & = p(r|t) \\
%  P(a|e,t,r,l) & = p(a|e,t) \\
%  P(l|e,t,r,a) & = p(l|a) \\
%  \end{align*}
% }
% \end{textblock}
% 
  
 \end{frame}

 
 \begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Modelos Causales \\
 \large Prior Entradera
 \end{textblock}
 \vspace{0.75cm}
 
 \centering
 
 \begin{textblock}{160}(0,25)
  $P(e)$ \\[0.1cm]
    \begin{tabular}{|c|c|}
        \hline
        \,$e^0$\, & \,$e^1$\, \\ \hline
        \onslide<3>{$999/1000$} & \onslide<3>{$1/1000$}   \\ \hline
    \end{tabular}
  \end{textblock}

\begin{textblock}{160}(10,54) 
\onslide<2->{ 
 \begin{itemize}
  \item[$\bullet$] Una vez cada 3 años
  \item[$\bullet$] Una casa cada 1000 por día
 \end{itemize}
}
\end{textblock}

 
 \end{frame}
 
 \begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Modelos Causales \\
 \large Prior Terremoto
 \end{textblock}
 \vspace{0.75cm}
 
 \centering

 \begin{textblock}{160}(0,25)
  $P(t)$ \\[0.1cm]
    \begin{tabular}{|c|c|}
        \hline
        \,$t^0$\, & \,$t^1$\, \\ \hline
        \onslide<3>{$362/365$} & \onslide<3>{$3/365$}   \\ \hline
    \end{tabular}
\end{textblock}

 
 \begin{textblock}{160}(10,54)
\onslide<2->{ 
 \begin{itemize}
  \item[$\bullet$] Hay 3 terremotos (leves) por años
 \end{itemize}
}
\end{textblock}

 
 \end{frame}
 
 \begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Modelos Causales \\
 \large Prior redes sociales
 \end{textblock}
 \vspace{0.75cm}
 
 \centering

 
 \begin{textblock}{160}(0,25)
  $P(r|t)$ \\[0.1cm]
    \begin{tabular}{|c|c|c|}
        \hline
        & \, $r^0$ \, & \, $r^1$ \,  \\ \hline
       $(t^0)$ & \only<3-4>{$1$}\only<5>{$0.99$} & \only<3-4>{$0$}\only<5>{$0.01$}   \\ \hline
       $(t^1)$ & \only<3-4>{$0$}\only<5>{$0.01$} & \only<3-4>{$1$}\only<5>{$0.99$}   \\ \hline
    \end{tabular}
\end{textblock}

 
 \begin{textblock}{140}(10,54)
\onslide<2->{ 
 \begin{itemize}
  \item[$\bullet$] Siempre que hay un terremoto, en alguna de mis redes sociales (whatsapp, facebook, twitter, instagram), se habla del tema.
  \only<4->{\item[$\bullet$] También puedo mirar mal, o por algún momento no haya nada, o que por algún otro motivo nadie pueda comunicarse}
 \end{itemize}
}
\end{textblock}

 
 \end{frame}
 
 
 \begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Modelos Causales \\
 \large Prior llamada
 \end{textblock}
 \vspace{0.75cm}
 
 \centering

 
 \begin{textblock}{160}(0,25)
  $P(l|a)$ \\[0.1cm]
    \begin{tabular}{|c|c|c|}
        \hline
        & \, $l^0$ \, & \, $l^1$ \,  \\ \hline
       $(a^0)$ & \onslide<3>{$0.99$} & \onslide<3>{$0.01$}   \\ \hline
       $(a^1)$ & \onslide<3>{$0.01$} & \onslide<3>{$0.99$}   \\ \hline
    \end{tabular}
\end{textblock}

 
 \begin{textblock}{140}(10,54)
\onslide<2->{ 
 \begin{itemize}
  \item[$\bullet$] Siempre que se activa la alarma, me llaman desde el call center de la empresa (si no pasa nada raro)
 \end{itemize}
}
\end{textblock}

 \end{frame}
 
 
 \begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Modelos Causales \\
 \large Prior alarma
 \end{textblock}
 \vspace{0.75cm}
 
 \centering

 
 \begin{textblock}{160}(0,18)
  $P(l|a)$ \\[0.1cm]
    \begin{tabular}{|c|c|c|}
        \hline
        & \hspace{1cm} $a^0$ \hspace{1cm} & \hspace{1cm} $a^1$ \hspace{1cm} \\ \hline
       $(e^0, t^0)$ & \only<10->{$0.99$}\only<4-9>{$P(\overline{\alpha})$} & \only<11->{$0.01$}\only<4-10>{$P(\alpha)$} \\ \hline
       $(e^1, t^0)$ & \only<13->{$\approx 0.01$}\only<12>{$0.99 \cdot 0.01$}\only<7-11>{$P(\overline{\alpha} \cap \overline{\varepsilon})$}\only<6>{$P(\overline{\alpha \cup \varepsilon})$} & \only<14->{$\approx 0.99$} \only<5-13>{$P(\alpha \cup \varepsilon)$}  \\ \hline
       $(e^0, t^1)$ & \only<15->{$\approx 0.01$}\only<8-14>{$P(\overline{\alpha} \cap \overline{\tau})$} &\only<15->{$\approx0.99$}\only<8-14>{$P(\alpha \cup \tau)$}  \\ \hline 
       $(e^1, t^1)$ & \only<16>{$\approx 0.0001$} \only<9-15>{$P(\overline{\alpha} \cap \overline{\varepsilon}  \cap \overline{\tau})$} & \only<16>{$\approx 0.9999$} \only<9-15>{$P(\alpha \cup \varepsilon \cup \tau)$}  \\ \hline 
    \end{tabular}
\end{textblock}

 
 \begin{textblock}{140}(10,52)
\onslide<2->{ 
 \begin{itemize}
  \item[$\bullet$] Siempre que entra alguien a la casa o que hay un terremoto se activa la alarma (si no pasa nada raro):
  \onslide<3->{
  \begin{description}
   \item[$\alpha$] Se activa sola: $P(\alpha) = 0.01$
   \item[$\overline{\varepsilon}$] No se activa a pesar de entradera: $P(\overline{\varepsilon}) = 0.01$ 
   \item[$\overline{\tau}$] No se activa a pesar de terremoto: $P(\overline{\tau}) = 0.01$
  \end{description}
}
 \end{itemize}
}
\end{textblock}

 \end{frame}
 
 
 \begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Modelos Causales
 \end{textblock}
 
\begin{textblock}{160}(0,12)
 \centering

 \tikz{
    \node[det] (l) {$l$} ; %
    \node[det, above=of l] (a) {$a$} ; %
    \node[det, above=of a,xshift=1.5cm] (t) {$t$} ; %
    \node[det, above=of a,xshift=-1.5cm] (e) {$e$} ; %
    \node[det, below=of t,xshift=1.5cm] (r) {$r$} ; %
    
    \edge {a} {l};
    \edge {t,e} {a};
    \edge {t} {r};
    
    \onslide<2->{
    \node[const, left= of e, xshift=-0.1cm] (cpd_e) {
    \begin{tabular}{|c|c|}
        \hline
        $e^0$ & $e^1$ \\ \hline
        $0.999$ & $0.001$  \\ \hline
    \end{tabular}
    };
    \node[const, above= of cpd_e] (n_e) {Entradera:};
        }
    
    \onslide<3->{
    \node[const, right= of t, xshift=0.1cm] (cpd_t) {
    \begin{tabular}{|c|c|}
        \hline
        $t^0$ & $t^1$ \\ \hline
        $0.992$ & $0.008$  \\ \hline
    \end{tabular}
    };
    \node[const, above= of cpd_t] (n_t) {Terremoto:};
    }
    
    \onslide<4->{
    \node[const, left= of a, yshift=-0.7cm, xshift=-0.3cm] (cpd_a) {
    \begin{tabular}{|c|c|c|}
        \hline
        & $a^0$ & $a^1$ \\ \hline
       ($e^0, t^0$) & $0.99$ & $0.01$  \\ \hline
       ($e^1, t^0$) & $0.01$ & $0.99$  \\ \hline
       ($e^0, t^1$) & $0.01$ & $0.99$  \\ \hline
       ($e^1, t^1$) & $0.0001$ & $0.9999$  \\ \hline
    \end{tabular}
    };
    \node[const, above= of cpd_a] (n_a) {Alarma:};
    }
 
 \onslide<5->{
    \node[const, right= of r, xshift=0.1cm] (cpd_r) {
    \begin{tabular}{|c|c|c|}
        \hline
        & \, $r^0$ \, & \, $r^1$ \,  \\ \hline
       $(t^0)$ & $0.99$ & $0.01$   \\ \hline
       $(t^1)$ & $0.01$ & $0.99$   \\ \hline
    \end{tabular}
    };
    \node[const, above= of cpd_r] (n_r) {Redes:};
    }
    
 
 \onslide<6->{
    \node[const, right= of l, xshift=0.1cm] (cpd_l) {
    \begin{tabular}{|c|c|c|}
        \hline
        & \, $l^0$ \, & \, $l^1$ \,  \\ \hline
       $(t^0)$ & $0.99$ & $0.01$   \\ \hline
       $(t^1)$ & $0.01$ & $0.99$   \\ \hline
    \end{tabular}
    };
    \node[const, above= of cpd_l] (n_l) {Llamada:};
    }
    
 
 }
\end{textblock}
\end{frame}


\begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Modelos Causales
 \end{textblock}
 
\begin{textblock}{160}(0,12)
 \centering

 \tikz{
    \node[det] (l) {$l$} ; %
    \node[det, above=of l] (a) {$a$} ; %
    \node[det, above=of a,xshift=1.5cm] (t) {$t$} ; %
    \node[det, above=of a,xshift=-1.5cm] (e) {$e$} ; %
    \node[det, below=of t,xshift=1.5cm] (r) {$r$} ; %
    
    \edge {a} {l};
    \edge {t,e} {a};
    \edge {t} {r};
    
    \node[const, left= of e, xshift=-0.1cm] (cpd_e) {
    \begin{tabular}{|c|c|}
        \hline
        $e^0$ & $e^1$ \\ \hline
        $0.999$ & $0.001$  \\ \hline
    \end{tabular}
    };
    \node[const, above= of cpd_e] (n_e) {Entradera:};
    
    \node[const, right= of t, xshift=0.1cm] (cpd_t) {
    \begin{tabular}{|c|c|}
        \hline
        $t^0$ & $t^1$ \\ \hline
        $0.992$ & $0.008$  \\ \hline
    \end{tabular}
    };
    \node[const, above= of cpd_t] (n_t) {Terremoto:};

    \node[const, left= of a, yshift=-0.7cm, xshift=-0.3cm] (cpd_a) {
    \begin{tabular}{|c|c|c|}
        \hline
        & $a^0$ & $a^1$ \\ \hline
       ($e^0, t^0$) & $0.99$ & $0.01$  \\ \hline
       ($e^1, t^0$) & $0.01$ & $0.99$  \\ \hline
       ($e^0, t^1$) & $0.01$ & $0.99$  \\ \hline
       ($e^1, t^1$) & $0.0001$ & $0.9999$  \\ \hline
    \end{tabular}
    };
    \node[const, above= of cpd_a] (n_a) {Alarma:};

    \node[const, right= of r, xshift=0.1cm] (cpd_r) {
    \begin{tabular}{|c|c|c|}
        \hline
        & \, $r^0$ \, & \, $r^1$ \,  \\ \hline
       $(t^0)$ & $0.99$ & $0.01$   \\ \hline
       $(t^1)$ & $0.01$ & $0.99$   \\ \hline
    \end{tabular}
    };
    \node[const, above= of cpd_r] (n_r) {Redes:};
 
    \node[const, right= of l, xshift=0.1cm] (cpd_l) {
    \begin{tabular}{|c|c|c|}
        \hline
        & \, $l^0$ \, & \, $l^1$ \,  \\ \hline
       $(t^0)$ & $0.99$ & $0.01$   \\ \hline
       $(t^1)$ & $0.01$ & $0.99$   \\ \hline
    \end{tabular}
    };
    \node[const, above= of cpd_l] (n_l) {Llamada:};    
 
 }
\end{textblock}

\only<1>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(e^0,t^0,a^0,r^0,l^0) = P(e^0)P(t^0)P(a^0|t^0,e^0)P(r^0|t^0)P(l^0|a^0) && 
\end{flalign*}
\end{textblock}
}

\only<2>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(e^0,t^0,a^0,r^0,l^0) = 0.999 \cdot P(t^0)P(a^0|t^0,e^0)P(r^0|t^0)P(l^0|a^0) && 
\end{flalign*}
\end{textblock}
}

\only<3>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(e^0,t^0,a^0,r^0,l^0) = 0.999 \cdot 0.992 \cdot 0.99 \cdot 0.99 \cdot 0.99 && 
\end{flalign*}
\end{textblock}
}

\only<4>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(e^0,t^0,a^0,r^0,l^0) = 0.999 \cdot 0.992 \cdot 0.99 \cdot 0.99 \cdot 0.99 \approx 0.96 && 
\end{flalign*}
\end{textblock}
}

\only<5>{
 \begin{textblock}{130}(15,63)
 \begin{flalign*}
  & P(a^1) =  \phantom{ \sum_{h,i,j,k}} &&
 \end{flalign*}
 \end{textblock}
}

\only<6>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(a^1) = \sum_h\sum_i\sum_j\sum_k P(e^h,t^i,a^1,r^j,l^k) && 
\end{flalign*}
\end{textblock}
}

\only<7>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(a^1) = \sum_{h,i,j,k} P(e^h,t^i,a^1,r^j,l^k) && 
\end{flalign*}
\end{textblock}
}

\only<8>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(a^1) = \sum_{h,i,j,k} P(e^h)P(t^i)P(a^1|t^i,e^h)P(r^j|t^i)P(l^k|a^1) && 
\end{flalign*}
\end{textblock}
}

\only<9>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
  P(a^1) & = P(l^0|a^1) \sum_{h,i,j} P(e^h)P(t^i)P(a^1|t^i,e^h)P(r^j|t^i) \\
 & + P(l^1|a^1) \sum_{h,i,j} P(e^h)P(t^i)P(a^1|t^i,e^h)P(r^j|t^i) &&
\end{flalign*}
\end{textblock}
}

\only<10>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(a^1) = \Big(\sum_k P(l^k|a^1) \Big) \Big(\sum_{h,i,j} P(e^h)P(t^i)P(a^1|t^i,e^h)P(r^j|t^i) \Big) && 
\end{flalign*}
\end{textblock}
}


\only<11>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(a^1) = \Big(\sum_k P(l^k|a^1) \Big) \Big(\sum_{h,i} P(e^h)P(t^i)P(a^1|t^i,e^h)(\sum_j P(r^j|t^i)) \Big) && 
\end{flalign*}
\end{textblock}
}


\only<12>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(a^1) = \Big(\cancel{\sum_k P(l^k|a^1)} \Big) \Big(\sum_{h,i} P(e^h)P(t^i)P(a^1|t^i,e^h)(\sum_j P(r^j|t^i)) \Big) && 
\end{flalign*}
\end{textblock}
}



\only<13>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(a^1) = \Big(\cancel{\sum_k P(l^k|a^1)} \Big) \Big(\sum_{h,i} P(e^h)P(t^i)P(a^1|t^i,e^h)(\cancel{\sum_j P(r^j|t^i)}) \Big) && 
\end{flalign*}
\end{textblock}
}

\only<14>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(a^1) = \sum_{h,i} P(e^h)P(t^i)P(a^1|t^i,e^h) \phantom{\cancel{\sum_h}}&& 
\end{flalign*}
\end{textblock}
}

\only<15>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(a^1) = \sum_{h,i} P(e^h)P(t^i)P(a^1|t^i,e^h) = ?  && 
\end{flalign*}
\end{textblock}
}

\only<16>{
\begin{textblock}{130}(15,63)
\begin{flalign*}
 & P(a^1) = \sum_{h,i} P(e^h)P(t^i)P(a^1|t^i,e^h) \approx 0.019  && 
\end{flalign*}
\end{textblock}
}

\end{frame}


\begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Grafo de factorización
\end{textblock}

\begin{textblock}{40}(5,12)
\centering
\begin{figure}[H]
\centering
  \scalebox{0.8}{
\tikz{ %
        
        
        \node[factor] (fa) {} ;
        \node[const,right=of fa] (pa) {$P(a|e,t)$} ;
        \node[det, below=of fa, yshift=0.1cm] (a) {$a$} ; %
        
        \node[factor, below=of a] (fl) {} ;
        \node[const,right=of fl] (pl) {$P(l|a)$} ;
        \node[det, below=of fl,yshift=0.1cm] (l) {$l$} ; %
        
        \node[det, above=of fa, xshift=-1.6cm,yshift=-0.1cm] (e) {$e$} ; %
        \node[factor, above=of e,yshift=-0.1cm] (fe) {} ;
        \node[const,right=of fe] (pe) {$P(e)$} ;
        
        \node[det, above=of fa, xshift=1.6cm,yshift=-0.1cm] (t) {$t$} ; %
        \node[factor, above=of t,yshift=-0.1cm] (ft) {} ;
        \node[const,right=of ft] (pt) {$P(t)$} ;
        \node[factor, below=of t, xshift=1.6cm,yshift=0.1cm] (fr) {} ;
        \node[det,below=of fr,yshift=0.1cm] (r) {$r$} ; %
        \node[const,right=of fr] (pr) {$P(r|t)$} ;
        
        
        \edge[-] {fa} {a,e,t};
        \edge[-] {fe} {e};
        \edge[-] {ft} {t};
        \edge[-] {fr} {r,t};
        \edge[-] {fl} {l,a};
        } 
}   
\end{figure}
\end{textblock}

\begin{textblock}{115}(45,30)
 
 \centering Nodos: \\ variables y funciones
 
 \vspace{1cm}
 
 \centering Ejes: \\ 
  ``la variable $v$ es argumento de la funci\'on $f$''
 
\end{textblock}
\end{frame}


\begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Sum-product algorithm
\end{textblock}

\large \centering

Algoritmo para calcular cualquier marginal $P(x)$ \\ mediante pasaje de mensajes entre nodos.

\end{frame}

\begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Sum-product algorithm
\end{textblock}

\only<1->{
\begin{textblock}{80}(45,30)
\begin{description}
 \item[$n(v)$ :] Conjunto de nodos vecinos del nodo $v$
 \item[$m_{x \rightarrow f}(x)$ :] Mensaje de variable $x$ a factor $f$ 
 \onslide<3->{\item[$m_{f \rightarrow x}(x)$ :] Mensaje factor $f$ a variable $x$}
\end{description}
\end{textblock}
}

\only<1->{
\begin{textblock}{80}(45,16)
\begin{equation*}
P(x) = \prod_{h \in n(x)} m_{h \rightarrow x} 
\end{equation*} 
\end{textblock}
}

\only<2->{
\begin{textblock}{80}(45,56)
\begin{equation*}\label{eq:m_v_f}
m_{x \rightarrow f}(x) = \prod_{h \in n(x) \setminus \{f\} } m_{h \rightarrow x}(x)
\end{equation*}
\end{textblock}
}

\only<4->{
\begin{textblock}{80}(45,68)
\begin{equation*}\label{eq:m_f_v}
 m_{f \rightarrow x}(x) = \sum_{X\setminus \{x\} } \Big( f(X) \prod_{h \in n(f) \setminus \{x\} } m_{h \rightarrow f}(h) \Big) 
\end{equation*}
\end{textblock}
}

\only<1->{
\begin{textblock}{40}(0,20)
\centering
\begin{figure}[H]
\centering
  \scalebox{.8}{
\tikz{ %
        
        
        \node[factor] (fa) {} ;
        \node[det, below=of fa, minimum size=0.55cm, yshift=0.4cm] (a) {$a$} ; %
        
        \node[factor, below=of a, yshift=0.4cm] (fl) {} ;
        \node[det, below=of fl, minimum size=0.55cm,yshift=0.4cm] (l) {$l$} ; %
        
        \node[det, above=of fa, minimum size=0.55cm, xshift=-0.8cm, yshift=-0.4cm] (e) {$e$} ; %
        \node[factor, above=of e, yshift=-0.4cm] (fe) {} ;
        
        \node[det,minimum size=0.55cm, above=of fa, xshift=0.8cm, yshift=-0.4cm] (t) {$t$} ; %
        \node[factor, above=of t, yshift=-0.4cm] (ft) {} ;
        \node[factor, below=of t, xshift=0.8cm, yshift=0.4cm] (fr) {} ;
        \node[det,minimum size=0.55cm, below=of fr, yshift=0.4cm] (r) {$r$} ; %
        
        \edge[-] {fa} {a,e,t};
        \edge[-] {fe} {e};
        \edge[-] {ft} {t};
        \edge[-] {fr} {r,t};
        \edge[-] {fl} {l,a};
        } 
}   
\end{figure}
\end{textblock}
}

% % 
\only<5>{
\begin{textblock}{160}(0,87)
\centering \tiny
\href{https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=910572}{Kschischang FR, Frey BJ, Loeliger HA. Factor graphs and the sum-product algorithm. 2001}
\end{textblock}
}
\end{frame}

\begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Grafo de factorización
\end{textblock}

\begin{textblock}{40}(5,12)
\centering
\begin{figure}[H]
\centering
  \scalebox{0.8}{
\tikz{ %
        
        
        \node[factor] (fa) {} ;
        %\node[const,left=of fa] (pa) {$P(a|e,t)$} ;
        \node[det, below=of fa, yshift=0.1cm] (a) {$a$} ; %
        
        \node[factor, below=of a] (fl) {} ;
        %\node[const,right=of fl] (pl) {$P(l|a)$} ;
        \node[det, below=of fl,yshift=0.1cm] (l) {$l$} ; %
        
        \node[det, above=of fa, xshift=-1.6cm,yshift=-0.1cm] (e) {$e$} ; %
        \node[factor, above=of e,yshift=-0.1cm] (fe) {} ;
        %\node[const,right=of fe] (pe) {$P(e)$} ;
        
        \node[det, above=of fa, xshift=1.6cm,yshift=-0.1cm] (t) {$t$} ; %
        \node[factor, above=of t,yshift=-0.1cm] (ft) {} ;
        %\node[const,right=of ft] (pt) {$P(t)$} ;
        \node[factor, below=of t, xshift=1.6cm,yshift=0.1cm] (fr) {} ;
        \node[det,below=of fr,yshift=0.1cm] (r) {$r$} ; %
        %\node[const,left=of fr] (pr) {$P(r|t)$} ;
        
        
        \edge[-] {fa} {a,e,t};
        \edge[-] {fe} {e};
        \edge[-] {ft} {t};
        \edge[-] {fr} {r,t};
        \edge[-] {fl} {l,a};
        
        \onslide<1->{\path[draw, ->, fill=black!50] (fe) edge[bend left,draw=black!50] node[right,color=black!75] {\only<2->{$P(e)$}} (e);}
        \onslide<3>{\path[draw, ->, fill=black!50] (e) edge[bend left,draw=black!50] node[above,color=black!75] {$P(e)$} (fa);}
        \onslide<4->{\path[draw, ->, fill=black!50] (ft) edge[bend left,draw=black!50] node[right,color=black!75] {$P(t)$} (t);}
        \onslide<5->{\path[draw, ->, fill=black!50] (fr) edge[bend left,draw=black!50] node[right,color=black!75] {\only<6->{$1$}} (t);}
        \onslide<7->{\path[draw, ->, fill=black!50] (fl) edge[bend left,draw=black!50] node[left,color=black!75] {$1$} (a);}
        \onslide<8->{\path[draw, ->, fill=black!50] (fa) edge[bend left,draw=black!50] node[left,color=black!75] {\only<11->{$1$}} (t);}
        \onslide<12->{\path[draw, ->, fill=black!50] (fa) edge[bend left,draw=black!50] node[left,color=black!75] {$1$} (e);}
        \onslide<14->{\path[draw, ->, fill=black!50] (fr) edge[bend left,draw=black!50] node[right,color=black!75] {\only<15->{$P(r)$}} (r);}
        \onslide<16->{\path[draw, ->, fill=black!50] (fa) edge[bend left,draw=black!50] node[right,color=black!75] {\only<17->{$P(a)$}} (a);}
        \onslide<18->{\path[draw, ->, fill=black!50] (fl) edge[bend left,draw=black!50] node[right,color=black!75] {$P(l)$} (l);}
        }
}   
\end{figure}
\end{textblock}

\begin{textblock}{100}(65,16)
 $m_{f_e\rightarrow e}(e) = \onslide<2->{P(e)} \onslide<3>{= m_{e\rightarrow f_a}(e)}$  \\
 \onslide<4->{$m_{f_t\rightarrow t}(t) = P(t)$ } \\
 $\onslide<5->{m_{f_r\rightarrow t}(t) = \sum_r \, P(r|t)} \onslide<6->{= 1}$  \\
 $\onslide<7->{m_{f_l\rightarrow a}(a) = \sum_l \, P(l|a) = 1} $  \\
 \onslide<8->{$m_{f_a\rightarrow t}(t) = \sum_{ea} \, P(e) P(a|e,t) \only<9>{= \sum_{e} \, P(e) \sum_{a} P(a|e,t) } \only<10>{= \sum_{e} \, P(e)} \only<11->{= 1 }$  }\\
 \onslide<12->{$m_{f_a\rightarrow e}(e) = \sum_{ta} \, P(t) P(a|e,t) = 1$ } \\
 \onslide<14->{$m_{f_r\rightarrow r}(r) = \sum_{t} \, P(t) P(r|t) \onslide<15->{= P(r)}$ } \\
 \onslide<16->{$m_{f_a\rightarrow a}(a) = \sum_{et} \, P(e)P(t)P(a|e,t)  \onslide<17->{= P(a)}$ } \\
 \onslide<18->{$m_{f_l\rightarrow l}(l) = \sum_{a} \, P(a) P(l|a) = P(l)$ }
 \end{textblock}

 \only<13>{
\begin{textblock}{80}(60,60)
 \centering
 Todos los mensajes \\ que suben son $1$
\end{textblock}
}

 \only<19>{
\begin{textblock}{80}(60,70)
 \centering
 Todos los mensajes que \\ bajan son marginales 
\end{textblock}
}


 \only<20>{
\begin{textblock}{80}(60,65)
 \centering
 \begin{align*}
  P(l=1)\cdot 365 = ?
 \end{align*}
\end{textblock}
}

\end{frame}




\begin{frame}[plain]
\begin{textblock}{160}(0,4)
\centering \Large Flujos de inferencia
\end{textblock}

\only<2->{
\begin{textblock}{160}(0,18)
\centering
 \begin{tabular}{c c|c}
 & $\hfrac{\text{Intermedio}}{\text{no observable}}$ &   $\hfrac{\text{Intermedio}}{\text{observable}}$ \\
 & & \\
 $ e \rightarrow a \rightarrow l $    & \onslide<3->{$P(l) \overset{?}{=} P(l|e)$} & \onslide<4->{$P(l|a) \overset{?}{=} P(l|e,a)$} \\ 
 $ l \leftarrow a \leftarrow t $      &  \onslide<5->{$P(t) \overset{?}{=} P(t|l)$}  & \onslide<6->{$P(t|a) \overset{?}{=} P(t|a,l)$} \\ 
 $ a \leftarrow t \rightarrow r $     & \onslide<7->{$P(r) \overset{?}{=} P(r|a)$} & \onslide<8->{$P(r|t) \overset{?}{=} P(r|t,a)$} \\
 $ e \rightarrow a \leftarrow t $     & \onslide<9->{$P(t) \overset{?}{=} P(t|e)$} & \onslide<10->{$P(t|a) \overset{?}{=} P(t|e,a)$} \\
            $\overset{\downarrow}{l}$  & \onslide<11->{$P(t) \overset{?}{=} P(t|e)$} & \onslide<11->{$P(t|l) \overset{?}{=} P(t|e,l)$}
 \end{tabular} 
 \end{textblock}
 }
 

\end{frame}

\begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Grafo de factorización
\end{textblock}

\begin{textblock}{40}(5,12)
\centering
\begin{figure}[H]
\centering
  \scalebox{0.8}{
\tikz{ %
        
        
        \node[factor] (fa) {} ;
        %\node[const,left=of fa] (pa) {$P(a|e,t)$} ;
        \node[det, below=of fa, yshift=0.1cm] (a) {$a$} ; %
        
        \node[factor, below=of a] (fl) {} ;
        %\node[const,right=of fl] (pl) {$P(l|a)$} ;
        \node[det, below=of fl,yshift=0.1cm] (l) {$l$} ; %
        
        \node[det, above=of fa, xshift=-1.6cm,yshift=-0.1cm] (e) {$e$} ; %
        \node[factor, above=of e,yshift=-0.1cm] (fe) {} ;
        %\node[const,right=of fe] (pe) {$P(e)$} ;
        
        \node[det, above=of fa, xshift=1.6cm,yshift=-0.1cm] (t) {$t$} ; %
        \node[factor, above=of t,yshift=-0.1cm] (ft) {} ;
        %\node[const,right=of ft] (pt) {$P(t)$} ;
        \node[factor, below=of t, xshift=1.6cm,yshift=0.1cm] (fr) {} ;
        \node[det,below=of fr,yshift=0.1cm] (r) {$r$} ; %
        %\node[const,left=of fr] (pr) {$P(r|t)$} ;
        
        
        \edge[-] {fa} {a,e,t};
        \edge[-] {fe} {e};
        \edge[-] {ft} {t};
        \edge[-] {fr} {r,t};
        \edge[-] {fl} {l,a};
        
        \onslide<1->{\path[draw, ->, fill=black!50] (fe) edge[bend left,draw=black!50] node[right,color=black!75] {\only<1->{$P(e)$}} (e);}
        \onslide<1->{\path[draw, ->, fill=black!50] (ft) edge[bend left,draw=black!50] node[right,color=black!75] {$P(t)$} (t);}
        \onslide<1->{\path[draw, ->, fill=black!50] (fr) edge[bend left,draw=black!50] node[left,color=black!75] {\only<1->{$1$}} (t);}
        \onslide<1->{\path[draw, ->, fill=black!50] (fl) edge[bend left,draw=black!50] node[left,color=black!75] {$1$} (a);}
        \onslide<1->{\path[draw, ->, fill=black!50] (fa) edge[bend left,draw=black!50] node[left,color=black!75] {\only<1->{$1$}} (t);}
        \onslide<1->{\path[draw, ->, fill=black!50] (fa) edge[bend left,draw=black!50] node[left,color=black!75] {$1$} (e);}
        \onslide<1->{\path[draw, ->, fill=black!50] (fr) edge[bend left,draw=black!50] node[right,color=black!75] {\only<1->{$P(r)$}} (r);}
        \onslide<1->{\path[draw, ->, fill=black!50] (fa) edge[bend left,draw=black!50] node[right,color=black!75] {\only<1->{$P(a)$}} (a);}
        \onslide<1->{\path[draw, ->, fill=black!50] (fl) edge[bend left,draw=black!50] node[right,color=black!75] {$P(l)$} (l);}
        }
}   
\end{figure}
\end{textblock}

\begin{textblock}{100}(65,16)
 $\onslide<1->{m_{f_e\rightarrow e}(e) = P(e)}$  \\
 \onslide<1->{$m_{f_t\rightarrow t}(t) = P(t)$ } \\
 $\onslide<1->{m_{f_r\rightarrow t}(t) = \sum_r \, P(r|t) = 1}$  \\
 $\onslide<1->{m_{f_l\rightarrow a}(a) = \sum_l \, P(l|a) = 1} $  \\
 \onslide<1->{$m_{f_a\rightarrow t}(t) = \sum_{ea} \, P(e) P(a|e,t) = 1 $  }\\
 \onslide<1->{$m_{f_a\rightarrow e}(e) = \sum_{ta} \, P(t) P(a|e,t) = 1$ } \\
 \onslide<1->{$m_{f_r\rightarrow r}(r) = \sum_{t} \, P(t) P(r|t) = P(r)$ } \\
 \onslide<1->{$m_{f_a\rightarrow a}(a) = \sum_{et} \, P(e)P(t)P(a|e,t)  = P(a)$ } \\
 \onslide<1->{$m_{f_l\rightarrow l}(l) = \sum_{a} \, P(a) P(l|a) = P(l)$ }
 \end{textblock}


\end{frame}


\begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Grafo de factorización
\end{textblock}

\begin{textblock}{40}(5,12)
\centering
\begin{figure}[H]
\centering
  \scalebox{0.8}{
\tikz{ %
        
        
        \node[factor] (fa) {} ;
        %\node[const,left=of fa] (pa) {$P(a|e,t)$} ;
        \node[det, below=of fa, yshift=0.1cm] (a) {$a$} ; %
        
        \node[factor, below=of a] (fl) {} ;
        %\node[const,right=of fl] (pl) {$P(l|a)$} ;
        \node[det, below=of fl,yshift=0.1cm] (l) {$l$} ; %
        
        \node[det, fill=black!10,above=of fa, xshift=-1.6cm,yshift=-0.1cm] (e) {$e$} ; %
        \node[factor, above=of e,yshift=-0.1cm] (fe) {} ;
        %\node[const,right=of fe] (pe) {$P(e)$} ;
        
        \node[det, above=of fa, xshift=1.6cm,yshift=-0.1cm] (t) {$t$} ; %
        \node[factor, above=of t,yshift=-0.1cm] (ft) {} ;
        %\node[const,right=of ft] (pt) {$P(t)$} ;
        \node[factor, below=of t, xshift=1.6cm,yshift=0.1cm] (fr) {} ;
        \node[det,below=of fr,yshift=0.1cm] (r) {$r$} ; %
        %\node[const,left=of fr] (pr) {$P(r|t)$} ;
        
        
        \edge[-] {fa} {a,e,t};
        \edge[-] {fe} {e};
        \edge[-] {ft} {t};
        \edge[-] {fr} {r,t};
        \edge[-] {fl} {l,a};
        
        \path[draw, ->, fill=black!50] (fe) edge[bend left,draw=black!50] node[right,color=black!75] {\only<1>{$?$}\only<2->{$P(e^*)$}} (e);
        \path[draw, ->, fill=black!50] (ft) edge[bend left,draw=black!50] node[right,color=black!75] {$P(t)$} (t);
        \path[draw, ->, fill=black!50] (fr) edge[bend left,draw=black!50] node[left,color=black!75] {\only<1->{$1$}} (t);
        \path[draw, ->, fill=black!50] (fl) edge[bend left,draw=black!50] node[left,color=black!75] {$1$} (a);
        \onslide<3->{\path[draw, ->, fill=black!50] (fa) edge[bend left,draw=black!50] node[left,color=black!75] {\only<4->{$P(e^*)$}} (t);}
        \path[draw, ->, fill=black!50] (fa) edge[bend left,draw=black!50] node[left,color=black!75] {$1$} (e);
        \onslide<5->{\path[draw, ->, fill=black!50] (fr) edge[bend left,draw=black!50] node[right,color=black!75] {\only<6->{$P(r,e^*)$}} (r);}
        \onslide<7->{\path[draw, ->, fill=black!50] (fa) edge[bend left,draw=black!50] node[right,color=black!75] {\only<8->{$P(a,e^*)$}} (a);}
        \onslide<9->{\path[draw, ->, fill=black!50] (fl) edge[bend left,draw=black!50] node[right,color=black!75] {\only<10->{$P(l,e^*)$}} (l);}
        }
}   
\end{figure}
\end{textblock}

\begin{textblock}{100}(65,16)
 $m_{f_e\rightarrow e}(e) = \onslide<2->{P(e^*)} $  \\
 $m_{f_t\rightarrow t}(t) = \onslide<1->{P(t)}$  \\
 $m_{f_r\rightarrow t}(t) = \onslide<1->{\sum_r \, P(r|t) = 1}$  \\
 $m_{f_l\rightarrow a}(a) = \onslide<1->{\sum_l \, P(l|a) = 1} $  \\
 $m_{f_a\rightarrow t}(t) = \onslide<3->{\sum_{t} \, P(e^*) P(a|e^*,t)} \onslide<4->{= P(e^*)}$  \\
 $m_{f_a\rightarrow e}(e) = \onslide<1->{\sum_{ta} \, P(t) P(a|e,t) = 1}$  \\
 $m_{f_r\rightarrow r}(r) = \onslide<5->{\sum_{t} \, P(t) P(r|t)} \onslide<6->{= P(r,e^*)}$ \\
 $m_{f_a\rightarrow a}(a) = \onslide<7->{\sum_{t} \, P(e^*)P(t)P(a|e^*,t)}\onslide<8->{  = P(a,e^*)}$  \\
 $m_{f_l\rightarrow l}(l) = \onslide<9->{\sum_{a} \, P(a,e^*) P(l|a)} \onslide<10->{ = P(l,e^*)}$
 \end{textblock}

 
\only<11-13>{
\begin{textblock}{80}(70,60)
\begin{flalign*}
  P(t,e^*) & = P(e^*) P(t) \\
  \onslide<12->{P(t|e^*) &= \frac{P(e^*) P(t) }{P(e^*)}} \onslide<13->{= P(t)}&&
\end{flalign*}
\end{textblock}
}

\only<14-15>{
\begin{textblock}{80}(70,60)
\begin{flalign*}
  P(l|e^*) & \, = P(l,e^*)/P(e^*) \only<15>{\overset{?}= \, P(l)} &&
\end{flalign*}
\end{textblock}
}

\only<16>{
\begin{textblock}{80}(69.15,60)
\begin{flalign*}
  \underbrace{P(l|e^*)}_{\hfrac{\text{que llamen}}{\text{cuando entran}}} & = P(l,e^*)/P(e^*) \overset{?}=  \underbrace{P(l)}_{\hfrac{\text{que llamen}}{\text{}}} &&
\end{flalign*}
\end{textblock}
}



 
\end{frame}



\begin{frame}[plain]
\begin{textblock}{160}(0,4)
\centering \Large Flujos de inferencia
\end{textblock}

\begin{textblock}{160}(0,18)
\centering
 \begin{tabular}{c c|c}
 & $\hfrac{\text{Intermedio}}{\text{no observable}}$ &   $\hfrac{\text{Intermedio}}{\text{observable}}$ \\
 & & \\
 $ e \rightarrow a \rightarrow l $    & $P(l) \only<1>{\overset{?}{=}}\only<2->{\neq} P(l|e)$ & $P(l|a) \overset{?}{=} P(l|e,a)$ \\ 
 $ l \leftarrow a \leftarrow t $      &  $P(t) \overset{?}{=} P(t|l)$  & $P(t|a) \overset{?}{=} P(t|a,l)$ \\ 
 $ a \leftarrow t \rightarrow r $     & $P(r) \overset{?}{=} P(r|a)$ & $P(r|t) \overset{?}{=} P(r|t,a)$ \\
 $ e \rightarrow a \leftarrow t $     & $P(t) \only<-2>{\overset{?}{=}}\only<3->{=} P(t|e)$ & $P(t|a) \overset{?}{=} P(t|e,a)$ \\
            $\overset{\downarrow}{l}$  & $P(t) \only<-3>{\overset{?}{=}}\only<4->{=} P(t|e)$ & $P(t|l) \overset{?}{=} P(t|e,l)$
 \end{tabular} 
 \end{textblock}
 

\end{frame}


\begin{frame}[plain]
\begin{textblock}{160}(0,4)
 \centering \Large
 Grafo de factorización
\end{textblock}

\begin{textblock}{40}(5,12)
\centering
\begin{figure}[H]
\centering
  \scalebox{0.8}{
\tikz{ %
        
        
        \node[factor] (fa) {} ;
        %\node[const,left=of fa] (pa) {$P(a|e,t)$} ;
        \node[det, fill=black!10, below=of fa, yshift=0.1cm] (a) {$a$} ; %
        
        \node[factor, below=of a] (fl) {} ;
        %\node[const,right=of fl] (pl) {$P(l|a)$} ;
        \node[det, below=of fl,yshift=0.1cm] (l) {$l$} ; %
        
        \node[det, above=of fa, xshift=-1.6cm,yshift=-0.1cm] (e) {$e$} ; %
        \node[factor, above=of e,yshift=-0.1cm] (fe) {} ;
        %\node[const,right=of fe] (pe) {$P(e)$} ;
        
        \node[det, above=of fa, xshift=1.6cm,yshift=-0.1cm] (t) {$t$} ; %
        \node[factor, above=of t,yshift=-0.1cm] (ft) {} ;
        %\node[const,right=of ft] (pt) {$P(t)$} ;
        \node[factor, below=of t, xshift=1.6cm,yshift=0.1cm] (fr) {} ;
        \node[det,below=of fr,yshift=0.1cm] (r) {$r$} ; %
        %\node[const,left=of fr] (pr) {$P(r|t)$} ;
        
        
        \edge[-] {fa} {a,e,t};
        \edge[-] {fe} {e};
        \edge[-] {ft} {t};
        \edge[-] {fr} {r,t};
        \edge[-] {fl} {l,a};
        
        \path[draw, ->, fill=black!50] (fe) edge[bend left,draw=black!50] node[right,color=black!75] {\only<1>{$P(e)$}} (e);
        \path[draw, ->, fill=black!50] (ft) edge[bend left,draw=black!50] node[right,color=black!75] {$P(t)$} (t);
        \path[draw, ->, fill=black!50] (fr) edge[bend left,draw=black!50] node[left,color=black!75] {\only<1->{$1$}} (t);
        \path[draw, ->, fill=black!50] (fl) edge[bend left,draw=black!50] node[left,color=black!75] {$1$} (a);
        \onslide<3->{\path[draw, ->, fill=black!50] (fa) edge[bend left,draw=black!50] node[left,color=black!75] {} (t);}
        \onslide<2->{\path[draw, ->, fill=black!50] (fa) edge[bend left,draw=black!50] node[left,color=black!75] {} (e);}
        \onslide<4->{\path[draw, ->, fill=black!50] (fr) edge[bend left,draw=black!50] node[right,color=black!75] {\only<5->{$P(r,a^*)$}} (r);}
        \onslide<6->{\path[draw, ->, fill=black!50] (fa) edge[bend left,draw=black!50] node[right,color=black!75] {\only<7->{$P(a^*)$}} (a);}
        \onslide<8->{\path[draw, ->, fill=black!50] (fl) edge[bend left,draw=black!50] node[right,color=black!75] {\only<9->{$P(l,a^*)$}} (l);}
        }
}   
\end{figure}
\end{textblock}

\begin{textblock}{100}(65,16)
 $m_{f_e\rightarrow e}(e) = \onslide<1->{P(e)} $  \\
 $m_{f_t\rightarrow t}(t) = \onslide<1->{P(t)}$  \\
 $m_{f_r\rightarrow t}(t) = \onslide<1->{\sum_r \, P(r|t) = 1}$  \\
 $m_{f_l\rightarrow a}\phantom{(a)} = \onslide<1->{\sum_l \, P(l|a^*) = 1} $  \\
 $m_{f_a\rightarrow t}(t) = \onslide<3->{\sum_{e} \, P(e) P(a^*|e,t)}$  \\
 $m_{f_a\rightarrow e}(e) = \onslide<2->{\sum_t P(t)P(a^*|e,t)}$  \\
 $m_{f_r\rightarrow r}(r) = \onslide<4->{\sum_{et} \, P(e)P(t) P(a^*|e,t) P(r|t)} \onslide<5->{= P(r,a^*)}$ \\
 $m_{f_a\rightarrow a}\phantom{(a)} = \onslide<6->{\sum_{et} \, P(e)P(t)P(a^*|e,t)}\onslide<7->{  = P(a^*)}$  \\
 $m_{f_l\rightarrow l}(l) = \onslide<8->{P(a^*) P(l|a^*)} \onslide<9->{ = P(l,a^*)}$
 \end{textblock}

 
\only<10->{
\begin{textblock}{80}(65,60)
\begin{flalign*}
  P(t,a^*) & = \sum_{e} \, P(e) P(t) P(a^*|e,t) \\ 
  P(e,a^*) & = \sum_{t} \, P(e) P(t) P(a^*|e,t) \\
  &&
  \end{flalign*}
\end{textblock}
}

 
\end{frame}





\begin{frame}[plain]
\centering
  \includegraphics[width=0.35\textwidth]{../../aux/static/pachacuteckoricancha.jpg}
\end{frame}


\end{document}



